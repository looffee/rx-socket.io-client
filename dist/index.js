/*! For license information please see index.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("rxjs"),require("rxjs/operators"),require("socket.io-client")):"function"==typeof define&&define.amd?define(["rxjs","rxjs/operators","socket.io-client"],e):"object"==typeof exports?exports.rx_socketio_client=e(require("rxjs"),require("rxjs/operators"),require("socket.io-client")):t.rx_socketio_client=e(t.rxjs,t.rxjs.operators,t.io)}(this,(function(t,e,n){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return o})),n.d(e,"__assign",(function(){return i})),n.d(e,"__rest",(function(){return c})),n.d(e,"__decorate",(function(){return a})),n.d(e,"__param",(function(){return s})),n.d(e,"__metadata",(function(){return u})),n.d(e,"__awaiter",(function(){return l})),n.d(e,"__generator",(function(){return f})),n.d(e,"__createBinding",(function(){return _})),n.d(e,"__exportStar",(function(){return d})),n.d(e,"__values",(function(){return p})),n.d(e,"__read",(function(){return h})),n.d(e,"__spread",(function(){return v})),n.d(e,"__spreadArrays",(function(){return y})),n.d(e,"__await",(function(){return b})),n.d(e,"__asyncGenerator",(function(){return O})),n.d(e,"__asyncDelegator",(function(){return w})),n.d(e,"__asyncValues",(function(){return E})),n.d(e,"__makeTemplateObject",(function(){return N})),n.d(e,"__importStar",(function(){return P})),n.d(e,"__importDefault",(function(){return C})),n.d(e,"__classPrivateFieldGet",(function(){return m})),n.d(e,"__classPrivateFieldSet",(function(){return x}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function c(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function a(t,e,n,r){var o,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(c=(i<3?o(c):i>3?o(e,n,c):o(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c}function s(t,e){return function(n,r){e(n,r,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(o,i){function c(t){try{s(r.next(t))}catch(t){i(t)}}function a(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,a)}s((r=r.apply(t,e||[])).next())}))}function f(t,e){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function _(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}function d(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])}function p(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),c=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],c=0,a=i.length;c<a;c++,o++)r[o]=i[c];return r}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function O(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(t,e||[]),i=[];return r={},c("next"),c("throw"),c("return"),r[Symbol.asyncIterator]=function(){return this},r;function c(t){o[t]&&(r[t]=function(e){return new Promise((function(n,r){i.push([t,e,n,r])>1||a(t,e)}))})}function a(t,e){try{(n=o[t](e)).value instanceof b?Promise.resolve(n.value.v).then(s,u):l(i[0][2],n)}catch(t){l(i[0][3],t)}var n}function s(t){a("next",t)}function u(t){a("throw",t)}function l(t,e){t(e),i.shift(),i.length&&a(i[0][0],i[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,o){e[r]=t[r]?function(e){return(n=!n)?{value:b(t[r](e)),done:"return"===r}:o?o(e):e}:o}}function E(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=p(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,o){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,o,(e=t[n](e)).done,e.value)}))}}}function N(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function P(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function C(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function x(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n(0).__exportStar(n(2),e)},function(t,e,n){"use strict";var r,o,i,c,a;Object.defineProperty(e,"__esModule",{value:!0}),e.RxSocketClient=e.Status=void 0;const s=n(0),u=n(3),l=n(4),f=n(5);var _;!function(t){t[t.NOT_CONNECTED=0]="NOT_CONNECTED",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.RECONNECTING=3]="RECONNECTING",t[t.RECONNECTED=4]="RECONNECTED",t[t.DISCONNECTED=5]="DISCONNECTED",t[t.CLOSED=6]="CLOSED"}(_=e.Status||(e.Status={}));e.RxSocketClient=class{constructor(t,e={},n=(()=>!1)){if(this.serverUrl=t,this.socketOptions=e,this.errorPredicationCallback=n,r.set(this,null),o.set(this,new u.BehaviorSubject(_.NOT_CONNECTED)),i.set(this,()=>{if(null===s.__classPrivateFieldGet(this,r))throw new Error("Socket is not inited!");return s.__classPrivateFieldGet(this,r)}),c.set(this,()=>s.__classPrivateFieldGet(this,o).pipe(l.distinctUntilChanged()).pipe(l.filter(t=>t===_.DISCONNECTED)).pipe(l.map(()=>{}))),a.set(this,t=>u.merge(s.__classPrivateFieldGet(this,c).call(this).pipe(l.flatMap(()=>u.throwError("Socket connection lost!"))),t)),"string"!=typeof t)throw new Error('"serverUrl" isn\'t provided!')}get id(){return s.__classPrivateFieldGet(this,i).call(this).id}get status(){return s.__classPrivateFieldGet(this,o).value}get status$(){return s.__classPrivateFieldGet(this,o).asObservable()}init(){if(this.status===_.CONNECTED)throw new Error("Trying to connect already connected socket connection!");if(this.status===_.CONNECTING)throw new Error("Previous connecting is pending!");return s.__classPrivateFieldGet(this,o).next(_.CONNECTING),new u.Observable(t=>{const e=f.connect(this.serverUrl,"object"==typeof this.socketOptions?this.socketOptions:this.socketOptions()),n=e=>{s.__classPrivateFieldGet(this,o).next(_.NOT_CONNECTED),t.error(e)};e.once("connect_error",n),e.once("connect_timeout",n),e.once("connect",()=>{e.off("connect_error",n),e.off("connect_timeout",n),s.__classPrivateFieldSet(this,r,e),s.__classPrivateFieldGet(this,o).next(_.CONNECTED),e.on("connect_error",()=>s.__classPrivateFieldGet(this,o).next(_.DISCONNECTED)),e.on("connect_timeout",()=>s.__classPrivateFieldGet(this,o).next(_.DISCONNECTED)),e.on("reconnecting",()=>s.__classPrivateFieldGet(this,o).next(_.RECONNECTING)),e.on("reconnect",()=>{s.__classPrivateFieldGet(this,o).next(_.RECONNECTED),s.__classPrivateFieldGet(this,o).next(_.CONNECTED)}),t.next(!0),t.complete()})})}close(){s.__classPrivateFieldGet(this,o).next(_.CLOSED),s.__classPrivateFieldGet(this,o).complete(),s.__classPrivateFieldGet(this,i).call(this).removeAllListeners(),s.__classPrivateFieldGet(this,i).call(this).close(),s.__classPrivateFieldSet(this,r,null)}emit(t,e={}){const n=new u.Observable(n=>{s.__classPrivateFieldGet(this,i).call(this).emit(t,"object"==typeof e?Object.assign({},e):{},t=>{this.errorPredicationCallback(t)?n.error(t):(n.next(t),n.complete())})});return s.__classPrivateFieldGet(this,a).call(this,n).pipe(l.take(1))}listen(t){const e=new u.Observable(e=>{function n(t){e.next(t)}return s.__classPrivateFieldGet(this,i).call(this).on(t,n),{unsubscribe:()=>{s.__classPrivateFieldGet(this,i).call(this).off(t,n)}}});return s.__classPrivateFieldGet(this,a).call(this,e)}listenWithAck(t){const e=new u.Observable(e=>{function n(t,n){e.next({ack:n,data:t})}return s.__classPrivateFieldGet(this,i).call(this).on(t,n),{unsubscribe:()=>{s.__classPrivateFieldGet(this,i).call(this).off(t,n)}}});return s.__classPrivateFieldGet(this,a).call(this,e)}},r=new WeakMap,o=new WeakMap,i=new WeakMap,c=new WeakMap,a=new WeakMap},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e){t.exports=n}])}));